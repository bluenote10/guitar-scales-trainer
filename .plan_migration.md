# Dependency Upgrade Plan

This plan upgrades the project in safe, verifiable increments. After each stage, we will validate with:

- npm run check
- npm run lint
- npm run build
- npm run preview
- npm run test

All work should be done on a feature branch. Target Node 20.x LTS (or 22.x).

## Stage 0: Baseline Snapshot

- npm ci
- Run all validation commands and document current green state.

## Stage 1: Safe patch/minor updates within current majors

- Refresh to latest patch/minor versions (no framework major bumps):
  - svelte 3.x, @sveltejs/kit 1.x, @sveltejs/adapter-static 2.x
  - vite 4.x
  - tailwind 3.x (minor), postcss 8.x (minor), autoprefixer 10.x (minor)
  - eslint 8.x, prettier 2.x, svelte-check 3.x, vitest 0.x (latest minor)
- Validate: check, lint, build, preview, test.

## Stage 2: App-agnostic libraries

- Update independent libraries to latest within their current majors (or majors known to be compatible):
  - classnames 2.x
  - @fontsource/\* latest 4.x (keep 4.x for now; revisit 5.x later if needed)
  - @svelte-put/shortcut 1.x
  - flowbite and flowbite-svelte: update within their current majors only; postpone major if it requires Svelte 4/5.
- Validate: check, lint, build, preview, test.

## Stage 3: Core tooling (pre-migration compatible) — COMPLETED

- Upgraded TypeScript → 5.x
- Confirmed tailwindcss at 3.4.x, postcss/autoprefixer current
- Upgraded Prettier → 3, prettier-plugin-svelte → 3
- Migrated ESLint rules to `eslint-plugin-svelte` while keeping legacy config (flat config in later stage)
- Removed `svelte-preprocess`, using `vitePreprocess({ postcss: true })`
- Validated: check, lint, build, test — all green

## Stage 4: SvelteKit 1 → 2 — COMPLETED

- Migrated to SvelteKit 2 (currently pinned to 2.5.x for Svelte 4 compatibility)
- @sveltejs/adapter-static → 3.x (GitHub Pages setup intact)
- Vite aligned to 5.x
- `svelte.config.js` uses `vitePreprocess` from `@sveltejs/vite-plugin-svelte`
- Validated: check, lint, build, test — all green

## Stage 5: Svelte 4 → 5 (compatibility mode)

- Bump:
  - svelte → ^5 (compat mode; no runes refactor yet)
  - @sveltejs/kit → latest ^2.x (brings vite-plugin-svelte v6)
  - flowbite → ^3, flowbite-svelte → ^1 (Svelte 5 compatible)
  - Keep vite at ^6 or consider ^7 once Kit is current
- Keep `vitePreprocess({ postcss: true })`
- Validate: check, lint, build, test
- If any dependency imports `svelte/internal`, bump/replace that lib (e.g. icon library)

## Stage 6: Post-upgrade verification and fixes

- Address any lingering Svelte 5 compatibility issues
- Replace outdated libs (e.g., swap icon lib if needed)
- Validate: check, lint, build, preview, test

## Stage 7: Linting/Formatting modernization — COMPLETED

- ESLint → 9.x (flat config) with `eslint.config.js`
- Migrated to `eslint-plugin-svelte` (flat config) and `svelte-eslint-parser`
- Upgraded `@typescript-eslint/*` to v8 (supports TS 5.9), added `typescript-eslint` meta package
- Prettier → 3.x and `prettier-plugin-svelte` → 3.x
- Moved ignore patterns into flat config (note: `.eslintignore` is deprecated)
- Validated `npm run lint` — green

## Stage 8: Optional Svelte 5 runes refactor

- Incremental refactors to the runes API.
- Validate.

## Stage 9: Cleanup

- Remove unused deps (e.g., `svelte-preprocess` if no longer needed beyond PostCSS).
- Update README and CI.
